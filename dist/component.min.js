!function(r,e){"function"==typeof define&&define.amd?define(["cargo.Promise","cargo.Model","cargo.Translation","virtualDom","html2hscript","Handlebars","superagent"],e):"object"==typeof exports?module.exports=e(require("cargo.Promise"),require("cargo.Model"),require("cargo.Translation"),require("virtualDom"),require("html2hscript"),require("Handlebars"),require("superagent")):(r.cargo=r.cargo||{},r.cargo.Component=e(r.cargo.Promise,r.cargo.Model,r.cargo.Translation,r.virtualDom,r.html2hscript,r.Handlebars,r.superagent))}(this,function(r,t,o,n,i,a,c){var u=function(u,s,d){"use strict";function l(e){return new r(function(r,t){c.get(e).end(function(o,n){var i=a.create();if(o)return void t("Unable to load template from '"+e+"': "+o);var c;try{var u=new DOMParser,s=u.parseFromString(n.text,"text/html");if(c=h(s).find("template").first(),!c||!c.length)return void t("Template '"+e+"' does not contain a <template> element in body.");c=c.html().trim(),c=i.compile(c)}catch(d){return void t("Unable to compile rendering function from template '"+e+"': "+d)}var l={};l.template=c;for(var f=["attach","update","detach"],m=0;m<f.length;m++){var g=f[m];try{var p=h(s).find("script."+g).first();if(p.length>0){var v=p.text();l[g]=new Function("node",v)}else l[g]=new Function("")}catch(d){return void t("Unable to install '"+g+"' function from template '"+e+"': "+d)}}r(l)})})}function f(r,t){var o=void 0,n=void 0,i=void 0,a=void 0;t.then(function(r){o=r.template,n=r.attach,i=r.update,a=r.detach});var c=function(r){return void 0===r||r instanceof e?void 0:o?void console.log("Rendering state: "+JSON.stringify(r)):void t.then(function(){console.log("Deferring state rendering: "+JSON.stringify(r)),c(r)})};return c}if(!r)throw new Error("cargo.Promise API is required.");if(!t)throw new Error("cargo.Model API is required.");if(!o)throw new Error("cargo.Translation API is required.");if(!n)throw new Error("Virtual DOM required. (https://github.com/Matt-Esch/virtual-dom)");if(!i)throw new Error("Module html2hscript required.");if(!c)throw new Error("superagent is required. (https://github.com/visionmedia/superagent)");if(!a)throw new Error("Handlebars is required. (https://github.com/wycats/handlebars.js/)");var h=window.$;n.h;d=d||{};var m=l(s),g=new t(d),p=f(g,m);return t.subscribe(g,p),g};return u});