

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Module: Component &mdash; cargo-js 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="cargo-js 0.1 documentation" href="index.html"/>
        <link rel="next" title="Module: Translation" href="module_translation.html"/>
        <link rel="prev" title="Module: Model" href="module_model.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> cargo-js
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="how_to_build.html">How to Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">General Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_model.html">Module: Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Module: Component</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-example-usage">Code example / Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#project-structure">Project structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-the-boilerplate">Setting up the boilerplate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-and-attaching-a-component">Defining and attaching a component</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualizing-state-changes">Visualizing state changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-an-html-template">Adding an HTML template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-interactivity">Adding interactivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-compiling-templates">Pre-compiling templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#constructor-new-component-options">constructor: new Component(options)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#static-template-load-templateurl-options">static: Template.load(templateURL, options)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#static-template-compile-dom-options">static: Template.compile(dom, options)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#component-attach-selector">component.attach(selector)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#renderer-renderer-render-state">Renderer: renderer.render(state)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#renderer-renderer-detach">Renderer: renderer.detach()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module_translation.html">Module: Translation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">cargo-js</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Module: Component</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/module_component.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-component">
<h1>Module: Component<a class="headerlink" href="#module-component" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This module provides a GUI Component programming model for web application. It is inspired by Facebook&#8217;s
React (<a class="reference external" href="https://facebook.github.io/react/">https://facebook.github.io/react/</a>) and uses a Virtual DOM implementation for its rendering engine. While it
follows the general ideas of React, it does some things very differently.</p>
<p>A Component represents a GUI element. It is conceived of a current state and its visual representation.
Let&#8217;s assume a GUI element for a navigation menu. The navigation menu contains some menu items which
direct the user to different parts of the web application. Additionally it contains a &#8220;Change language&#8221;
dropdown that let&#8217;s the user choose a translation for the web application. If the user switches to another language,
the navigation menu itself shows in the new language according to the entire web application.</p>
<p>In this example, the current state of the navigation menu consists of at least all the menu items and the currently selected
language to highlight in the language dropdown. Furthermore, the current translation of the
navigation menu is also part of its current state.</p>
<p>Thus, the current state of the navigation menu component is represented by:</p>
<ul class="simple">
<li>the menu items</li>
<li>the currently selected language</li>
<li>all available languages</li>
</ul>
<p>In Javascript the current state could be collected in a simple object like this:</p>
<div class="highlight-js"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">language</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">selected</span><span class="o">:</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
        <span class="nx">available</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;de&#39;</span><span class="p">,</span><span class="s1">&#39;en&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="nx">menu</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">about</span><span class="o">:</span> <span class="s1">&#39;http://...&#39;</span><span class="p">,</span>
        <span class="nx">contact</span><span class="o">:</span> <span class="s1">&#39;http://...&#39;</span><span class="p">,</span>
        <span class="nx">register</span><span class="o">:</span> <span class="s1">&#39;http://...&#39;</span><span class="p">,</span>
        <span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;http://...&#39;</span>
    <span class="p">},</span>
    <span class="nx">translation</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">about</span><span class="o">:</span> <span class="s1">&#39;About&#39;</span><span class="p">,</span>
        <span class="nx">contact</span><span class="o">:</span> <span class="s1">&#39;Contact&#39;</span><span class="p">,</span>
        <span class="nx">register</span><span class="o">:</span> <span class="s1">&#39;Sign up&#39;</span><span class="p">,</span>
        <span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;Login&#39;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table></div>
<p>The visual representation of this state could be something like this:</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;main-navigation&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;menu&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>About<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>Contact<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>Sign up<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>Login<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;language&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;active&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>English<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;de&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>Deutsch<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>In mathematical terms the visual representation is a function of the state:</p>
<blockquote>
<div>F(state) = HTML</div></blockquote>
<p>If the current state changes, its visual representation changes accordingly. Let&#8217;s say the
user selects another language. This should change the state to:</p>
<div class="highlight-js"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">language</span><span class="o">:</span> <span class="p">{</span>
<span class="hll">                <span class="nx">selected</span><span class="o">:</span> <span class="s1">&#39;de&#39;</span><span class="p">,</span>
</span>                <span class="nx">available</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;de&#39;</span><span class="p">,</span><span class="s1">&#39;en&#39;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="nx">menu</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">about</span><span class="o">:</span> <span class="s1">&#39;http://...&#39;</span><span class="p">,</span>
                <span class="nx">contact</span><span class="o">:</span> <span class="s1">&#39;http://...&#39;</span><span class="p">,</span>
                <span class="nx">register</span><span class="o">:</span> <span class="s1">&#39;http://...&#39;</span><span class="p">,</span>
                <span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;http://...&#39;</span><span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">translation</span><span class="o">:</span> <span class="p">{</span>
<span class="hll">                <span class="nx">about</span><span class="o">:</span> <span class="s1">&#39;Über uns&#39;</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">contact</span><span class="o">:</span> <span class="s1">&#39;Kontakt&#39;</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">register</span><span class="o">:</span> <span class="s1">&#39;Registrieren&#39;</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;Login&#39;</span>
</span>        <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table></div>
<p>The new state renders to a new visual representation:</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;main-navigation&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;menu&quot;</span><span class="p">&gt;</span>
<span class="hll">                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>Über uns<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span><span class="hll">                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>Kontakt<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span><span class="hll">                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>Registrieren<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span><span class="hll">                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>Login<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span>        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;language&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>English<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="hll">                <span class="p">&lt;</span><span class="nt">li</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;de&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;active&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span><span class="p">&gt;</span>Deutsch<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span>        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Because state changes automatically lead to a change of their visual representation, the visual
representation is never altered directly by e.g. manipulating the DOM tree. Instead state changes are
triggered through a well-defined set of <strong>state transitions</strong> and the automated process of
transforming the state to its visual representation is triggered whenever a state transition occurs.</p>
<p>In practical terms, the Component exposes a render function which receives the current state and creates a
HTML representation. This representation is compared to the current state of the DOM tree which is altered
to match the new representation.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>current state -&gt; render() -&gt; new HTML -&gt; diff&#39;ed to DOM -&gt; patch the DOM
</pre></div>
</div>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>This module uses the following libraries and modules:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="61%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Module</th>
<th class="head">Repository</th>
<th class="head">AMD module alias</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>morphdom</td>
<td><a class="reference external" href="https://github.com/patrick-steele-idem/morphdom">https://github.com/patrick-steele-idem/morphdom</a></td>
<td>morphdom</td>
</tr>
<tr class="row-odd"><td>superagent</td>
<td><a class="reference external" href="https://github.com/visionmedia/superagent">https://github.com/visionmedia/superagent</a></td>
<td>superagent</td>
</tr>
<tr class="row-even"><td>jQuery</td>
<td><a class="reference external" href="https://jquery.com">https://jquery.com</a></td>
<td>$</td>
</tr>
<tr class="row-odd"><td>underscore</td>
<td><a class="reference external" href="http://underscorejs.org/">http://underscorejs.org/</a></td>
<td>_</td>
</tr>
</tbody>
</table>
<p>All dependencies are provided in the <code class="docutils literal"><span class="pre">dist</span></code> directory at <a class="reference external" href="https://github.com/datenwelt/cargo-js.git">https://github.com/datenwelt/cargo-js.git</a>. Additionally
an implementation of the Promise/A+ specification is needed (which is provided by all modern browsers).</p>
</div>
<div class="section" id="code-example-usage">
<h2>Code example / Usage<a class="headerlink" href="#code-example-usage" title="Permalink to this headline">¶</a></h2>
<p>As a practical example, the navigation menu component from above is built from scratch with
requirejs for dependency management. Let&#8217;s start with an empty HTML page and a placeholder
for the nav menu. This is pretty much requirejs boilerplate.</p>
<div class="section" id="project-structure">
<h3>Project structure<a class="headerlink" href="#project-structure" title="Permalink to this headline">¶</a></h3>
<p>The overall project structure is:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>index.html
    js/app.js

    js/lib/component.js

    js/lib/third-party/jquery.js
    js/lib/third-party/morphdom.js
    js/lib/third-party/requirejs.js
    js/lib/third-party/superagent.js
    js/lib/third-party/handlebars.js
    js/lib/third-party/underscore.js

    html/nav.html
</pre></div>
</div>
<p>The file <code class="docutils literal"><span class="pre">index.html</span></code> is the web page which loads <code class="docutils literal"><span class="pre">app.js</span></code> via requirejs. The files in
<code class="docutils literal"><span class="pre">js/lib</span></code> come from the cargo repository, everything under <code class="docutils literal"><span class="pre">js/lib/third-party</span></code> comes
from third party vendors.</p>
<p>The file <code class="docutils literal"><span class="pre">html/nav.html</span></code> is an empty HTML-file for now and will carry the HTML template of
the navigation menu later.</p>
<p>We do not use any CSS or other styling for clarity. You can add it later if you want.</p>
</div>
<div class="section" id="setting-up-the-boilerplate">
<h3>Setting up the boilerplate<a class="headerlink" href="#setting-up-the-boilerplate" title="Permalink to this headline">¶</a></h3>
<p>Within <code class="docutils literal"><span class="pre">index.html</span></code> we define an element which later receives the rendered navigation menu. Note that
we load jQuery as a global and not by requirejs. Technically, this is not necessary but as most HTML frameworks require
jQuery it is needed as a global anyways.</p>
<p><code class="docutils literal"><span class="pre">index.html</span></code></p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Component.js - example project<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">nav</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;nav&quot;</span> <span class="p">/&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/lib/third-party/jquery.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">data-main</span><span class="o">=</span><span class="s">&quot;js/app.js&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;js/lib/third-party/require.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>In <code class="docutils literal"><span class="pre">js/app.js</span></code> we load all required dependencies and provide a starting point.</p>
<p><code class="docutils literal"><span class="pre">js/app.js</span></code></p>
<div class="highlight-js"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nx">require</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
        <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
                <span class="s1">&#39;cargo.Component&#39;</span><span class="o">:</span> <span class="s1">&#39;lib/component&#39;</span><span class="p">,</span>
                <span class="s1">&#39;morphdom&#39;</span><span class="o">:</span> <span class="s1">&#39;lib/third-party/morphdom&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Handlebars&#39;</span><span class="o">:</span> <span class="s1">&#39;lib/third-party/handlebars&#39;</span><span class="p">,</span>
                <span class="s1">&#39;superagent&#39;</span><span class="o">:</span> <span class="s1">&#39;lib/third-party/superagent&#39;</span>
                <span class="s1">&#39;underscore: &#39;</span><span class="nx">lib</span><span class="o">/</span><span class="nx">third</span><span class="o">-</span><span class="nx">party</span><span class="o">/</span><span class="nx">underscore</span>
        <span class="p">}</span>
<span class="p">});</span>

<span class="nx">require</span><span class="p">([</span><span class="s1">&#39;cargo.Component&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Component</span><span class="p">)</span> <span class="p">{</span>

<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>Next we define a global object <code class="docutils literal"><span class="pre">TRANSLATIONS</span></code> containing the English and German translations to
have them at hand when needed.</p>
<p><code class="docutils literal"><span class="pre">js/app.js</span></code></p>
<div class="highlight-js"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nx">require</span><span class="p">([</span><span class="s1">&#39;cargo.Component&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Component</span><span class="p">)</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">TRANSLATIONS</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;de&#39;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">about</span><span class="o">:</span> <span class="s1">&#39;Über uns&#39;</span><span class="p">,</span>
                        <span class="nx">contact</span><span class="o">:</span> <span class="s1">&#39;Kontakt&#39;</span><span class="p">,</span>
                        <span class="nx">register</span><span class="o">:</span> <span class="s1">&#39;Registrieren&#39;</span><span class="p">,</span>
                        <span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;Login&#39;</span>
                <span class="p">},</span>
                <span class="s1">&#39;en&#39;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="nx">about</span><span class="o">:</span> <span class="s1">&#39;About&#39;</span><span class="p">,</span>
                        <span class="nx">contact</span><span class="o">:</span> <span class="s1">&#39;Contact&#39;</span><span class="p">,</span>
                        <span class="nx">register</span><span class="o">:</span> <span class="s1">&#39;Sign up&#39;</span><span class="p">,</span>
                        <span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;Login&#39;</span>
                <span class="p">}</span>
        <span class="p">}</span>

<span class="p">});</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="defining-and-attaching-a-component">
<h3>Defining and attaching a component<a class="headerlink" href="#defining-and-attaching-a-component" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s define the navigation menu component and attach it to the <code class="docutils literal"><span class="pre">&lt;nav&gt;</span></code> element in the web page. The
<code class="docutils literal"><span class="pre">cargo.Component</span></code> module provides a builder to achieve this. Additionally we need a first action,
that constitutes the initial state of the component.</p>
<p><code class="docutils literal"><span class="pre">js/app.js</span></code></p>
<div class="highlight-js"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/* ... */</span>

<span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">language</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">selected</span><span class="o">:</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
                <span class="nx">available</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;de&#39;</span><span class="p">,</span> <span class="s1">&#39;en&#39;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="nx">menu</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">about</span><span class="o">:</span> <span class="s1">&#39;#about&#39;</span><span class="p">,</span>
                <span class="nx">contact</span><span class="o">:</span> <span class="s1">&#39;#contact&#39;</span><span class="p">,</span>
                <span class="nx">register</span><span class="o">:</span> <span class="s1">&#39;#register&#39;</span><span class="p">,</span>
                <span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;#login&#39;</span>
        <span class="p">},</span>
        <span class="nx">translation</span><span class="o">:</span> <span class="nx">TRANSLATIONS</span><span class="p">[</span><span class="s1">&#39;en&#39;</span><span class="p">]</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">component</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Component</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="nx">component</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="s1">&#39;#id&#39;</span><span class="p">);</span>
<span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>In line 50-51 we attach the component to the <code class="docutils literal"><span class="pre">&lt;nav</span> <span class="pre">id=&quot;nav&quot;&gt;</span></code> element. Attaching the component to the DOM
marks the selected nodes - in this case the <code class="docutils literal"><span class="pre">&lt;nav&gt;</span> <span class="pre">``</span> <span class="pre">element</span> <span class="pre">-</span> <span class="pre">as</span> <span class="pre">rendering</span> <span class="pre">targets</span> <span class="pre">for</span> <span class="pre">a</span> <span class="pre">renderer</span> <span class="pre">which</span> <span class="pre">is</span>
<span class="pre">returned</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">``attach()</span></code> method. This renderer has a method <code class="docutils literal"><span class="pre">render()</span></code> which receives the current state and
renders its HTML representation to the DOM.</p>
<p>If we run this example, we should see the current state as a JSON representation at the place where the placeholder
<code class="docutils literal"><span class="pre">&lt;nav&gt;</span></code> element was. That is the default behaviour of a component when it is not tied to a template yet.</p>
</div>
<div class="section" id="visualizing-state-changes">
<h3>Visualizing state changes<a class="headerlink" href="#visualizing-state-changes" title="Permalink to this headline">¶</a></h3>
<p>But let&#8217;s try something else before we connect the component to a template. We change the state and watch the GUI
update the <code class="docutils literal"><span class="pre">&lt;nav</span></code> element accordingly. We can attach another rendering operation with a different state inside a timer.</p>
<p><code class="docutils literal"><span class="pre">js/app.js</span></code></p>
<div class="highlight-js"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/* ... */</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">state</span><span class="p">.</span><span class="nx">language</span><span class="p">.</span><span class="nx">selected</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">language</span><span class="p">.</span><span class="nx">selected</span> <span class="o">===</span> <span class="s1">&#39;en&#39;</span> <span class="o">?</span> <span class="s1">&#39;de&#39;</span> <span class="o">:</span> <span class="s1">&#39;en&#39;</span><span class="p">;</span>
        <span class="nx">state</span><span class="p">.</span><span class="nx">translation</span> <span class="o">=</span> <span class="nx">TRANSLATIONS</span><span class="p">[</span><span class="nx">state</span><span class="p">.</span><span class="nx">language</span><span class="p">.</span><span class="nx">selected</span><span class="p">];</span>
        <span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
<span class="p">},</span> <span class="mi">3000</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>If we run this example, the component should change the language from English to German back and forth every
3 seconds. A timer changes the state within the callback and calls the <code class="docutils literal"><span class="pre">render()</span></code> with the new state. Accordingly the
visual representation changes as well. Note that, this happens without any direct DOM manipulation.</p>
</div>
<div class="section" id="adding-an-html-template">
<h3>Adding an HTML template<a class="headerlink" href="#adding-an-html-template" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s connect an HTML template to have a real visual representation for the navigation menu. First we define
the template in a separate HTML file and load this file.</p>
<p><code class="docutils literal"><span class="pre">html/nav.html</span></code></p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    <span class="cp">&lt;!DOCTYPE html&gt;</span>
    <span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;main-navigation&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;menu&quot;</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{menu.about}}&quot;</span><span class="p">&gt;</span>{{translation.about}}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{menu.contact}}&quot;</span><span class="p">&gt;</span>{{translation.contact}}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{menu.register}}&quot;</span><span class="p">&gt;</span>{{translation.register}}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{menu.login}}&quot;</span><span class="p">&gt;</span>{{translation.login}}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;language&quot;</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>English<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;de&quot;</span><span class="p">&gt;</span>Deutsch<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Component.js uses the Handlebars template engine (s. <a class="reference external" href="http://handlebarsjs.com">http://handlebarsjs.com</a>) and applies the current
state as context to the template. In short, there are placeholders which are enclosed in moustache like
braces which correspond to the properties of the state object. For instance, the state object holds
a property <code class="docutils literal"><span class="pre">menu</span></code> which is an object itself. The <code class="docutils literal"><span class="pre">menu</span></code> object contains the properties <code class="docutils literal"><span class="pre">about</span></code>, <code class="docutils literal"><span class="pre">contact</span></code>
etc. which hold the link targets for the menu item. In the template these link targets are referenced
by the placeholders <code class="docutils literal"><span class="pre">{{menu.about}}</span></code>  and <code class="docutils literal"><span class="pre">{{menu.contact}}</span></code>.</p>
<p>Let&#8217;s load the template into a variable and pass it to the builder. This connects the template
to the component. In the following code block we show the complete file <code class="docutils literal"><span class="pre">js/app.js</span></code> omitting some
details for brevity and a better overview.</p>
<p>Additionally we add a method to the renderer which changes the language.</p>
<p><code class="docutils literal"><span class="pre">js/app.js</span></code></p>
<div class="highlight-js"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    <span class="nx">require</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
            <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
                    <span class="cm">/* ... */</span>
            <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">require</span><span class="p">([</span><span class="s1">&#39;cargo.Component&#39;</span><span class="p">,</span> <span class="s1">&#39;cargo.Template&#39;</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Component</span><span class="p">,</span> <span class="nx">Template</span><span class="p">)</span> <span class="p">{</span>

            <span class="cm">/* ... */</span>

            <span class="nx">Template</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s2">&quot;html/nav.html&quot;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">template</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">comp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Component</span><span class="p">(</span><span class="nx">template</span><span class="p">);</span>
                    <span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="cm">/* ... */</span> <span class="p">};</span>
                    <span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="nx">comp</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="s1">&#39;#nav&#39;</span><span class="p">);</span>

                    <span class="nx">renderer</span><span class="p">.</span><span class="nx">changeLanguage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">lang</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">state</span><span class="p">.</span><span class="nx">language</span><span class="p">.</span><span class="nx">selected</span> <span class="o">=</span> <span class="nx">lang</span><span class="p">;</span>
                            <span class="nx">state</span><span class="p">.</span><span class="nx">translation</span> <span class="o">=</span> <span class="nx">TRANSLATIONS</span><span class="p">[</span><span class="nx">lang</span><span class="p">];</span>
                            <span class="k">return</span> <span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
                    <span class="p">};</span>

                    <span class="nb">window</span><span class="p">.</span><span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                            <span class="kd">var</span> <span class="nx">lang</span> <span class="o">=</span> <span class="nx">state</span><span class="p">.</span><span class="nx">language</span><span class="p">.</span><span class="nx">selected</span> <span class="o">===</span> <span class="s1">&#39;en&#39;</span> <span class="o">?</span> <span class="s1">&#39;de&#39;</span> <span class="o">:</span> <span class="s1">&#39;en&#39;</span><span class="p">;</span>
                            <span class="nx">renderer</span><span class="p">.</span><span class="nx">changeLanguage</span><span class="p">(</span><span class="nx">lang</span><span class="p">);</span>
                    <span class="p">},</span> <span class="mi">3000</span><span class="p">);</span>
            <span class="p">});</span>

    <span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal"><span class="pre">Template</span></code> module of Component.js has a static function <code class="docutils literal"><span class="pre">load()</span></code> which receives an URL as argument.
The function loads and compiles the file from the URL. Because loading the file is an asynchronous operation,
the function returns a Promise which is fulfilled with the template instance which can be used as input
to the <code class="docutils literal"><span class="pre">Component</span></code> constructor.</p>
<p>If we run the code so far, a (rather unstyled) HTML representation of the navigation menu should
be displayed in the web page. It consists of two unnumbered lists - one for the menu itself and
another for the language options. The language should change every 3 seconds from English to German
back and forth all over again.</p>
</div>
<div class="section" id="adding-interactivity">
<h3>Adding interactivity<a class="headerlink" href="#adding-interactivity" title="Permalink to this headline">¶</a></h3>
<p>To add some interactivity, lets remove the timer and add a click handler to the language menu instead.
We could add the click handler in <code class="docutils literal"><span class="pre">js/app.js</span></code> as soon as the component has rendered but there are
two problems with this approach. First, we have no way to determine when the HTML finishes rendering and
cannot register the event handler before the respective elements have been attached to the DOM.</p>
<p>The second problem may be even more important. Adding event handlers outside of the template, loses us
some flexibility. The event handler has to be attached to some specific element defined in the template.
If we reference this element <strong>outside</strong> of the template, we cannot change the HTML without
at least paying attention to the Javascript code and checking back the references between both files.</p>
<p>The cleaner approach would be not to reference the component&#8217;s DOM within its Javascript code at all.
That&#8217;s why we provide a way to define event handlers and DOM related stuff <strong>in the HTML template</strong>. Let&#8217;s
see it in our example template:</p>
<p><code class="docutils literal"><span class="pre">html/nav.html</span></code></p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
        <span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;main-navigation&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;menu&quot;</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{menu.about}}&quot;</span><span class="p">&gt;</span>{{translation.about}}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{menu.contact}}&quot;</span><span class="p">&gt;</span>{{translation.contact}}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{menu.register}}&quot;</span><span class="p">&gt;</span>{{translation.register}}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{menu.login}}&quot;</span><span class="p">&gt;</span>{{translation.login}}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;language&quot;</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>English<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#!&quot;</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;de&quot;</span><span class="p">&gt;</span>Deutsch<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="hll">        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;attach&quot;</span><span class="p">&gt;</span>
</span><span class="hll">                <span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class="hll">                <span class="nx">$</span><span class="p">(</span><span class="nx">node</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;ul.language li a[lang]&quot;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class="hll">                        <span class="kd">var</span> <span class="nx">lang</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;lang&#39;</span><span class="p">);</span>
</span><span class="hll">                        <span class="nx">renderer</span><span class="p">.</span><span class="nx">changeLanguage</span><span class="p">(</span><span class="nx">lang</span><span class="p">);</span>
</span><span class="hll">                <span class="p">});</span>
</span><span class="hll">        <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span>        <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>There is a <code class="docutils literal"><span class="pre">script</span></code> tag in the body of the template with the class <code class="docutils literal"><span class="pre">attach</span></code>. This script
is executed <strong>once</strong> when the component is attached to the DOM. It is the right place to
setup event handlers and other DOM related things that need to be executed before the
component is used. There are two more script classes  - <code class="docutils literal"><span class="pre">update</span></code> and <code class="docutils literal"><span class="pre">detach</span></code>. <code class="docutils literal"><span class="pre">update</span></code>
is executed whenever the component is re-rendered on state changes and <code class="docutils literal"><span class="pre">detach</span></code> is called
once when the component is destroyed.</p>
<p>In the execution context of these scripts, <code class="docutils literal"><span class="pre">this</span></code> is defined as a reference to the renderer and
a special variable <code class="docutils literal"><span class="pre">node</span></code> is defined as a reference to the DOM node of the component. You
can use <code class="docutils literal"><span class="pre">this</span></code> to access all methods of the renderer and trigger some interactive behaviour.</p>
</div>
<div class="section" id="pre-compiling-templates">
<span id="id1"></span><h3>Pre-compiling templates<a class="headerlink" href="#pre-compiling-templates" title="Permalink to this headline">¶</a></h3>
<p>There is gulp plugin for compiling templates for <a class="reference internal" href="#"><span class="doc">Module: Component</span></a>. It compiles an &lt;HTML&gt; template file to a pure
Javascript template to use in the constructor of <a class="reference internal" href="#"><span class="doc">Module: Component</span></a>. This is an example how to use it in a
<code class="docutils literal"><span class="pre">gulpfile.js</span></code>.</p>
<div class="highlight-js"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">compile</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./dist/node/index&#39;</span><span class="p">).</span><span class="nx">compileTemplate</span><span class="p">;</span>

<span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;build_example&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="s1">&#39;example/templates/LanguageMenu.html&#39;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">compile</span><span class="p">())</span>
            <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">rename</span><span class="p">(</span><span class="s1">&#39;LanguageMenu.js&#39;</span><span class="p">))</span>
            <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="s1">&#39;example/templates/&#39;</span><span class="p">));</span>
    <span class="p">});</span>
</pre></div>
</div>
<p>This gulp task reads the template file from &#8220;LanguageMenu.html&#8221; and compiles it to a Javascript file &#8220;LanguageMenu.js&#8221;.
The generated file is a UMD-wrapped Javascript implementation of the HTML template.</p>
<p>Please note, that the generated template requires a Handlebars runtime when used. The runtime is a version of Handlebars
which does not include the compiler and is much smaller in size (about 80% reduced). Additionally the template is
&#8220;ready to use&#8221; and does not require the compilation step which is necessary when loading a template on the fly with
<code class="docutils literal"><span class="pre">Template.load()</span></code>. An example how to use the compiled template in the browser with require.js:</p>
<div class="highlight-js"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span>    <span class="nx">define</span><span class="p">([</span><span class="s1">&#39;Component&#39;</span><span class="p">,</span> <span class="s1">&#39;./templates/LanguageMenu.js&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Component</span><span class="p">,</span> <span class="nx">template</span><span class="p">)</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">component</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Component</span><span class="p">(</span><span class="nx">template</span><span class="p">);</span>
        <span class="nx">component</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">);</span>
        <span class="cm">/* ... */</span>

    <span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>The template is one of the dependencies in the <code class="docutils literal"><span class="pre">define(...)</span></code> function (line #1) and available from a parameter
<code class="docutils literal"><span class="pre">template</span></code> within the wrapper function. This parameter variable is inserted into the constructor of
<code class="docutils literal"><span class="pre">Component</span></code> at line #3.</p>
</div>
<div class="section" id="conclusion">
<h3>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h3>
<p>By separating the component&#8217;s behaviour from its visual appearance and by accessing the
behaviour through <strong>state transitions</strong> as a well-defined interface, we think that we provided a
solution for writing large GUI applications in a more comprehensive and more concise manner.</p>
<p>We use modern concept&#8217;s from the Javascript world like Promises, Flux and React-style
application architecture to provide a clear data flow between the applications model
and it&#8217;s visual representation and try to avoid the syntactical overhead of JSX.</p>
<p>Our approach is very close to the up-coming &#8220;Web components&#8221; technology and may easily be
transformed into a programming model making use of them.</p>
<p>Please feel free to check the API documentation for a more in-depth look at our technology.</p>
</div>
</div>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="constructor-new-component-options">
<h3>constructor: new Component(options)<a class="headerlink" href="#constructor-new-component-options" title="Permalink to this headline">¶</a></h3>
<div class="highlight-js"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">component</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Component</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="nx">renderState</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;&lt;h1&gt;...&lt;/h1&gt;&quot;</span><span class="p">;</span> <span class="p">},</span>
        <span class="nx">onAttach</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{},</span>
        <span class="nx">onUpdate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{},</span>
        <span class="nx">onDetach</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{}</span>
    <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Creates a new instance of <code class="docutils literal"><span class="pre">Component</span></code>. The first and only argument to the constructor is an object with the follwing
options.</p>
<p><strong>Parameter: options</strong></p>
<p><code class="docutils literal"><span class="pre">options.renderState</span></code></p>
<p>A template function which receives the current state as input and renders an HTML string as return value. Most template
engines e.g. Handlebars provide such a function. The HTML must consist of exactly one element which may contain an
arbitrary number of child nodes. Whitespace before and after this element is removed.</p>
<p>If no <code class="docutils literal"><span class="pre">renderState</span></code> method is provided, the DOM node is rendered as a <code class="docutils literal"><span class="pre">&lt;PRE&gt;</span></code> element containing a JSON representation
of the current state.</p>
<p><code class="docutils literal"><span class="pre">options.onAttach</span></code></p>
<p>A callback function which is called once when the first rendering happened and the original DOM node has been
replaced with the rendered HTML. The <code class="docutils literal"><span class="pre">this</span></code> keyword is the <code class="docutils literal"><span class="pre">Renderer</span></code> instance of the component. The first parameter
to <code class="docutils literal"><span class="pre">onAttach</span></code> is the DOM node which has been rendered. If the CSS selector of the component includes more than one
DOM node, the <code class="docutils literal"><span class="pre">onAttach</span></code> callback is called once for each DOM node.</p>
<p>The <code class="docutils literal"><span class="pre">onAttach</span></code> callback can be used to register event handlers to the DOM node.</p>
<p><code class="docutils literal"><span class="pre">options.onUpdate</span></code></p>
<p>A callback function which is called whenever the component&#8217;s DOM node has been
rendered and updated within the DOM. This includes the first rendering <strong>after</strong> <code class="docutils literal"><span class="pre">onAttach</span></code> has been called.
The <code class="docutils literal"><span class="pre">this</span></code> keyword is the <code class="docutils literal"><span class="pre">Renderer</span></code> instance of the component. The first parameter to <code class="docutils literal"><span class="pre">onUpdate</span></code> is the DOM node
which has been rendered. If the CSS selector of the component includes more than one DOM node, the <code class="docutils literal"><span class="pre">onUpdate</span></code> callback
is called once for each DOM node whenever the node is updated.</p>
<p><code class="docutils literal"><span class="pre">options.onDetach</span></code></p>
<p>A callback function which is called once when the component&#8217;s DOM node has removed from the DOM. The <code class="docutils literal"><span class="pre">this</span></code> keyword
is the <code class="docutils literal"><span class="pre">Renderer</span></code> instance of the component. The first parameter to <code class="docutils literal"><span class="pre">onDetach</span></code> is the DOM node which has been
rendered. If the CSS selector of the component includes more than one DOM node, the <code class="docutils literal"><span class="pre">onDetach</span></code> callback is called
once for each DOM node.</p>
<p>The <code class="docutils literal"><span class="pre">onDetach</span></code> callback can be used to remove any event listeners previously registered in the <code class="docutils literal"><span class="pre">onAttach</span></code> callback.</p>
</div>
<div class="section" id="static-template-load-templateurl-options">
<span id="template-load"></span><h3>static: Template.load(templateURL, options)<a class="headerlink" href="#static-template-load-templateurl-options" title="Permalink to this headline">¶</a></h3>
<div class="highlight-js"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">handlebars</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="nx">handlebars</span><span class="p">.</span><span class="nx">registerHelper</span><span class="p">(</span><span class="cm">/*...*/</span><span class="p">);</span>

<span class="nx">Template</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s2">&quot;template.html&quot;</span><span class="p">,</span> <span class="nx">handlebars</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">template</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">comp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Component</span><span class="p">(</span><span class="nx">template</span><span class="p">);</span>
    <span class="nx">comp</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="s1">&#39;#id&#39;</span><span class="p">);</span>
    <span class="cm">/* ... */</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Loads a template file and creates a Component instance based on it. The template file is an HTML file and should
contain a <code class="docutils literal"><span class="pre">&lt;template</span> <span class="pre">id=&quot;template&quot;&gt;</span></code> element with an Handlebars template enclosed. This template is automatically
compiled using the (optionally provided) Handlebars environment from the second parameter. If this parameter is omitted,
the default environment is used. The resulting template function is used for rendering the state of the component.</p>
<p>Additionally the template file may contain <code class="docutils literal"><span class="pre">&lt;script&gt;</span></code> elements containing an <code class="docutils literal"><span class="pre">attach</span></code>, <code class="docutils literal"><span class="pre">update</span></code> or <code class="docutils literal"><span class="pre">detach</span></code> callback.
There must be one <code class="docutils literal"><span class="pre">&lt;script&gt;</span></code> element per callback with a class set to &#8220;attach&#8221;, &#8220;update&#8221; or &#8220;detach&#8221; respectively.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;attach&quot;</span><span class="p">&gt;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Attach callback has been called.&quot;</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Since loading the template file is an asynchronous operation, this function returns a Promise which resolves with
the component instance.</p>
<p>Example template file.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Title<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">template</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;template&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-content blue-grey white-text&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;divider&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:false;&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;white-text&quot;</span><span class="p">&gt;</span>English / English<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;de&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:false;&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;white-text&quot;</span><span class="p">&gt;</span>German / Deutsch<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;attach&quot;</span><span class="p">&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.dropdown-button&#39;</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="s1">&#39;[data-activates=&quot;language-menu&quot;]&#39;</span><span class="p">).</span><span class="nx">dropdown</span><span class="p">();</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">node</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">lang</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;lang&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nx">lang</span> <span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">lang</span><span class="p">);</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;detach&quot;</span><span class="p">&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">node</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p><strong>Parameters</strong></p>
<p><code class="docutils literal"><span class="pre">templateURL</span></code></p>
<p>The URL of the template file which can be absolute or relative to the base URI of the website.</p>
<p><code class="docutils literal"><span class="pre">options</span></code> (optional)</p>
<p>An options object to specify further dependencies and parameters for loading and compliling the template.</p>
<p><code class="docutils literal"><span class="pre">options.handlebars</span></code> (optional)</p>
<p>A Handlebars environment to use for compiling the template section of the file. (A separate environment can be retrieved
from <code class="docutils literal"><span class="pre">Handlebars.create()</span></code>.) If this parameter is omitted, the default Handlebars environment is used.</p>
<p><strong>Return value</strong></p>
<p>A Promise which resolves with the <code class="docutils literal"><span class="pre">Component``instance,</span> <span class="pre">when</span> <span class="pre">the</span> <span class="pre">template</span> <span class="pre">file</span> <span class="pre">has</span> <span class="pre">been</span> <span class="pre">loaded</span> <span class="pre">and</span> <span class="pre">compiled.</span> <span class="pre">If</span> <span class="pre">the</span> <span class="pre">file</span>
<span class="pre">cannot</span> <span class="pre">be</span> <span class="pre">loaded</span> <span class="pre">or</span> <span class="pre">fails</span> <span class="pre">compiling,</span> <span class="pre">the</span> <span class="pre">Promise</span> <span class="pre">is</span> <span class="pre">rejected</span> <span class="pre">with</span> <span class="pre">an</span> <span class="pre">``Error</span></code> instance.</p>
</div>
<div class="section" id="static-template-compile-dom-options">
<h3>static: Template.compile(dom, options)<a class="headerlink" href="#static-template-compile-dom-options" title="Permalink to this headline">¶</a></h3>
<p>Compiles a DOM node with a <code class="docutils literal"><span class="pre">&lt;template&gt;</span></code> element and optional <code class="docutils literal"><span class="pre">&lt;script&gt;</span></code> elements (see <a class="reference internal" href="#template-load"><span class="std std-ref">static: Template.load(templateURL, options)</span></a> for details)
to a pure Javascript template. The result is a string of Javascript code containing an object. Use <code class="docutils literal"><span class="pre">eval()</span></code> or some similar
technique to convert this string to an actual Javascript object if needed. Note that this function is not intended to
be used in that way rather than to create a pre-compiled and transportable version of the template to be saved into
a file or to be transmitted through e.g. HTTP from server to browser.</p>
<p>Although the template needs a Handlebars runtime to run, the stripped down version from <code class="docutils literal"><span class="pre">handlebars.runtime.js</span></code> can be
used. That is the version of Handlebars without the compiler, which is shipped with the standard Handlebars distribution.</p>
<p>The DOM node could be created from an HTML string by using the
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser">DOMParser()-API</a> in the browser. The preferred way to
create the DOM node is to do the compiling on the server with Node.js. There is a complete DOM implementation for
Node.js from :<a class="reference external" href="https://www.npmjs.com/package/jsdom">jsdom</a> or from Phantom.js. But the easiest way to compile your
templates is to use the gulp plugin which ships with this project (see <a class="reference internal" href="#pre-compiling-templates"><span class="std std-ref">Pre-compiling templates</span></a>).</p>
<p><strong>Parameters</strong></p>
<p><code class="docutils literal"><span class="pre">dom</span></code></p>
<p>The DOM node to compile the template from. The DOM tree beneath that node should at least include one <code class="docutils literal"><span class="pre">&lt;template&gt;</span></code>
element and optionally one <code class="docutils literal"><span class="pre">&lt;script&gt;</span></code> element for each of the lifecycle callbacks <code class="docutils literal"><span class="pre">attach</span></code>, <code class="docutils literal"><span class="pre">update</span></code> and <code class="docutils literal"><span class="pre">detach</span></code>.</p>
<p>See <a class="reference internal" href="#template-load"><span class="std std-ref">static: Template.load(templateURL, options)</span></a> for details on the HTML structure used by templates.</p>
<p><code class="docutils literal"><span class="pre">options</span></code></p>
<p>This is meant as a placeholder for future compiler options. Currently only the <code class="docutils literal"><span class="pre">handlebars</span></code> option is supported.</p>
<p><code class="docutils literal"><span class="pre">options.handlebars</span></code></p>
<p>The Handlebars environment to use for pre-compiling the template.</p>
<p><strong>Return Value</strong></p>
<p>A string with Javascript code to represent the pure Javascript implementation of the template.</p>
</div>
<div class="section" id="component-attach-selector">
<h3>component.attach(selector)<a class="headerlink" href="#component-attach-selector" title="Permalink to this headline">¶</a></h3>
<div class="highlight-js"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">component</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Component</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="nx">component</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="s1">&#39;#id&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Attaches the component to one or more DOM nodes and returns an instance of the rendering engine. The <code class="docutils literal"><span class="pre">selector</span></code> parameter
is an CSS selector which can target one ore more nodes. If more than one node is targeted all nodes are replaced and
rendered with the HTML from the rendering engine. The <code class="docutils literal"><span class="pre">component.attach()</span></code> method does not replace the DOM node
and does no rendering yet. It marks the targeted DOM nodes as rendering targets and prevents them from being used as
targets for other components. The first rendering takes place with the first call of the rendering method by the rendering
engine.</p>
<p><strong>Parameters</strong></p>
<p><code class="docutils literal"><span class="pre">selector</span></code></p>
<p>A CSS selector which determines the target nodes of the DOM tree.</p>
<p><strong>Return value</strong></p>
<p>A <code class="docutils literal"><span class="pre">Renderer</span></code> instance which holds the <code class="docutils literal"><span class="pre">render(state)</span></code> method to use for the actual rendering.</p>
<p><strong>Exceptions</strong></p>
<p>This method throws an <code class="docutils literal"><span class="pre">Error</span></code> instance in one of the following conditions:</p>
<ol class="arabic simple">
<li>The CSS selector is missing.</li>
<li>The CSS selector does not target any DOM nodes.</li>
<li>If one ore more of the targeted nodes are already attached to a component.</li>
</ol>
</div>
<div class="section" id="renderer-renderer-render-state">
<h3>Renderer: renderer.render(state)<a class="headerlink" href="#renderer-renderer-render-state" title="Permalink to this headline">¶</a></h3>
<div class="highlight-js"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">component</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Component</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="nx">component</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="s1">&#39;#id&#39;</span><span class="p">);</span>
<span class="nx">renderer</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span> <span class="p">{</span> <span class="nx">visible</span><span class="o">:</span> <span class="kc">true</span> <span class="p">});</span>
</pre></div>
</div>
<p>The instance <code class="docutils literal"><span class="pre">renderer</span></code> is the return value of the <code class="docutils literal"><span class="pre">component.attach()</span></code> method and contains a <code class="docutils literal"><span class="pre">render()</span></code> method.
This method renders an HTML representation of the <code class="docutils literal"><span class="pre">state</span></code> input. The input should be a plain Javascript object or
anything else which can be used by the <code class="docutils literal"><span class="pre">template</span></code> function passed to the Component constructor.</p>
<p>If the input is an object with a <code class="docutils literal"><span class="pre">this.toJS()</span></code> method, it is called to convert the input to a native Javascript
data structure. The <code class="docutils literal"><span class="pre">toJS()</span></code> method is available in instances of the <code class="docutils literal"><span class="pre">State</span></code> API from <a class="reference internal" href="module_model.html"><span class="doc">Module: Model</span></a> which makes
them a perfect input for the <code class="docutils literal"><span class="pre">render()</span></code> method.</p>
<p>Because rendering to the DOM tree is an asynchronous operations, the return value is a Promise which resolves with the
actual Javascript data structure that has been used for rendering (which may be different from the <code class="docutils literal"><span class="pre">state</span></code> input).</p>
<p><strong>Parameters</strong></p>
<p><code class="docutils literal"><span class="pre">state</span></code></p>
<p>The state object to render. If this is an object has a <code class="docutils literal"><span class="pre">toJS()</span></code> method, it is called and the return value is used for
rendering. If <code class="docutils literal"><span class="pre">state</span></code> is omitted or <code class="docutils literal"><span class="pre">undefined</span></code>, no rendering takes place. If <code class="docutils literal"><span class="pre">state</span></code> is an instance of <code class="docutils literal"><span class="pre">Error</span></code>
no rendering takes place and the Promise is rejected with that error.</p>
<p><strong>Return value</strong></p>
<p>A Promise which resolves with the actual state object that has been used for rendering. The Promise is resolved when
the rendering completed.</p>
</div>
<div class="section" id="renderer-renderer-detach">
<h3>Renderer: renderer.detach()<a class="headerlink" href="#renderer-renderer-detach" title="Permalink to this headline">¶</a></h3>
<div class="highlight-js"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">component</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Component</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">renderer</span> <span class="o">=</span> <span class="nx">component</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="s1">&#39;#id&#39;</span><span class="p">);</span>

<span class="cm">/* ... */</span>

<span class="nx">renderer</span><span class="p">.</span><span class="nx">detach</span><span class="p">();</span>
</pre></div>
</div>
<p>Destroys the component by replacing the DOM nodes with the original DOM nodes from before the first rendering. No more
rendering takes place after <code class="docutils literal"><span class="pre">detach()</span></code> has been called.</p>
<p><strong>Parameters</strong></p>
<p>This method takes no parameters.</p>
<p><strong>Return value</strong></p>
<p>This method does not return anything.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="module_translation.html" class="btn btn-neutral float-right" title="Module: Translation" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="module_model.html" class="btn btn-neutral" title="Module: Model" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jan Obladen.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>