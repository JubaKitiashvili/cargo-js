<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Component.js - Test file.</title>
    <link rel="shortcut icon" type="image/png" href="../../bower_components/jasmine-core/images/jasmine_favicon.png">
    <link rel="stylesheet" type="text/css" href="../../bower_components/jasmine-core/lib/jasmine-core/jasmine.css">

    <script type="text/javascript" src="../../bower_components/jasmine-core/lib/jasmine-core/jasmine.js"></script>
    <script type="text/javascript" src="../../bower_components/jasmine-core/lib/jasmine-core/jasmine-html.js"></script>
    <script type="text/javascript" src="../../bower_components/jasmine-core/lib/jasmine-core/boot.js"></script>
    <script type="text/javascript" src="../../bower_components/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="../../dist/promise.js"></script>
    <script type="text/javascript" src="../../dist/model.js"></script>
    <script type="text/javascript" src="../../bower_components/virtual-dom/dist/virtual-dom.js"></script>
    <script type="text/javascript" src="../../node_modules/superagent/superagent.js"></script>
    <script type="text/javascript" src="../../dist/dependencies/underscore.js"></script>
    <script type="text/javascript" src="../../bower_components/handlebars/handlebars.js"></script>
    <script type="text/javascript" src="../../dist/dependencies/html2hscript.js"></script>
    <script type="text/javascript" src="../../dist/translation.js"></script>
</head>
<body>

<nav id="test"></nav>
<script type="text/javascript">
    window.Promise = cargo.Promise;
    window.Model = cargo.Model;
    window.Translation = cargo.Translation;
</script>
<script type="text/javascript" src="Component.js"></script>
<script type="text/javascript">

    var translation = new Translation({
        baseURI: 'locales',
        namespace: 'test',
        languages: ['en', 'de'],
        defaultLang: 'en'
    });
    translation.select('en');

    var actions = {
        initialState: function () {
            return {items: []}
        },
        addItem: function (item) {
            var state = this.state();
            state.items = state.items || [];
            state.items.push(item);
            return state;
        },
        removeItem: function (item) {
            var state = this.state();
            state = state || {};
            var items = state.items || [];
            var newItems = [];
            for (var idx = 0; idx < items.length; idx++) {
                if (item != items[idx]) {
                    newItems.push(items[idx]);
                }
            }
            state.items = newItems;
            return state;
        },
        clearItems: function () {
            var state = this.state();
            state.items = [];
            return state;
        },
        deadState: function () {
            return new Error("Model already entered dead state.");
        }
    };

    describe("Constructor", function () {
        it("returning a model instance.", function () {
            var comp = new Component("#test", "templates/TestComponent.html", actions, {translation: translation });
            expect(comp).toBeDefined();
            expect(typeof comp).toEqual('function');
            var actual = _.chain(Object.getOwnPropertyNames(comp)).filter(function(prop) {
                return typeof comp[prop] === 'function';
            }).sort().value();
            var expected = _.chain(Object.getOwnPropertyNames(actions)).filter(function(prop) {
                return typeof comp[prop] === 'function';
            }).sort().value();
            expect(expected).toEqual(actual);
        });
    });



</script>


</body>
</html>
