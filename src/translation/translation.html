<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Component.js - Test file.</title>
    <link rel="shortcut icon" type="image/png" href="../../bower_components/jasmine-core/images/jasmine_favicon.png">
    <link rel="stylesheet" type="text/css" href="../../bower_components/jasmine-core/lib/jasmine-core/jasmine.css">

    <script type="text/javascript" src="../../bower_components/jasmine-core/lib/jasmine-core/jasmine.js"></script>
    <script type="text/javascript" src="../../bower_components/jasmine-core/lib/jasmine-core/jasmine-html.js"></script>
    <script type="text/javascript" src="../../bower_components/jasmine-core/lib/jasmine-core/boot.js"></script>
    <script type="text/javascript" src="../../bower_components/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="../../dist/promise.js"></script>
    <script type="text/javascript" src="../../dist/model.js"></script>
    <script type="text/javascript" src="../../dist/dependencies/underscore.js"></script>
    <script type="text/javascript" src="../../dist/dependencies/superagent.js"></script>
    <script type="text/javascript" src="../../dist/dependencies/js.cookie.js"></script>
</head>
<body>

<nav id="test"/>
<script type="text/javascript">
    window.Model = cargo.Model;
    window.Promise = cargo.Promise;
</script>
<script type="text/javascript" src="Translation.js"></script>
<script type="text/javascript">

    describe("Constructor", function () {
        it("returning a translation instance.", function () {
            var trans = new Translation();
            expect(trans).toBeDefined();
            expect(typeof trans).toBe("function");
        });
    });

    describe("Loading", function () {
        it(" the default translation without any options.", function (done) {
            var trans = new Translation();
            trans(function (state) {
                expect(state).toBeDefined();
                expect(typeof state).toBe("object");
                expect(state.GREETING).toBe("Hello World!");
                expect(state.READY).toBe("ready");
                done();
            });
            trans.select("en");
        });

        it(" the default translation when selecting an unknown language.", function (done) {
            var trans = new Translation();
            trans(function (state) {
                expect(state).toBeDefined();
                expect(typeof state).toBe("object");
                expect(state.GREETING).toBe("Hello World!");
                expect(state.READY).toBe("ready");
                done();
            });
            trans.select("fr");
        });

        it(" no translation when selecting a non-existent namespace.", function (done) {
            var trans = new Translation({namespace: "missing"});
            trans(function (state) {
                expect(state).toBeDefined();
                expect(typeof state).toBe("object");
                expect(state.GREETING).not.toBeDefined();
                expect(state.READY).not.toBeDefined();
                done();
            });
            trans.select("en");
        });

        it(" no translation when selecting a non-existent base URI.", function (done) {
            var trans = new Translation({baseURI: "missing"});
            trans(function (state) {
                expect(state).toBeDefined();
                expect(typeof state).toBe("object");
                expect(state.GREETING).not.toBeDefined();
                expect(state.READY).not.toBeDefined();
                done();
            });
            trans.select("en");
        });

        it(" the translation of the parent locale when selecting a non-existent specific locale.", function (done) {
            var trans = new Translation();
            trans(function (state) {
                expect(state).toBeDefined();
                expect(typeof state).toBe("object");
                expect(state.GREETING).toBe("Hello World!");
                expect(state.READY).toBe("ready");
                done();
            });
            trans.select("en_US");
        });

        it(" the correct translation when selecting a specific non-default locale.", function (done) {
            var trans = new Translation({languages: ['de_de', 'en']});
            trans(function (state) {
                expect(state).toBeDefined();
                expect(typeof state).toBe("object");
                expect(state.GREETING).toBe("Hallo Welt!");
                expect(state.READY).toBe("fertig");
                done();
            });
            trans.select("de_de");
        });

        it(" the translation of the parent locale when selecting a unspecific locale.", function (done) {
            var trans = new Translation({languages: ['de_de', 'en']});
            trans(function (state) {
                expect(state).toBeDefined();
                expect(typeof state).toBe("object");
                expect(state.GREETING).toBe("Hallo Welt!");
                expect(state.READY).toBe("fertig");
                done();
            });
            trans.select("de");
        });

    });

</script>


</body>
</html>
